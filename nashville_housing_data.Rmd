---
title: "Exploring the Nashville Residential Parcel Transaction Dataset (1970–2023)"
author: "Nicc Forster-Benson"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE, echo=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# Load libraries
library(tidyverse)
library(lubridate)
```

## Load the Dataset

```{r}
# Adjust path to where your dataset is stored
data <- read_csv("nashville_housing_data.csv")
```

## Data Cleaning

```{r}
# Ensure dates and numeric fields are parsed properly
data <- data %>%
  mutate(
    SaleDate = mdy(SaleDate),
    Year = year(SaleDate),
    SalePrice = as.numeric(SalePrice),
    Acres = as.numeric(Acres),
    FinishArea = as.numeric(FinishArea)
  )
```

## Sale Price Over Time

```{r}
data %>%
  group_by(Year) %>%
  summarise(MedianPrice = median(SalePrice, na.rm = TRUE)) %>%
  ggplot(aes(x = Year, y = MedianPrice)) +
  geom_line() +
  geom_point() +
  labs(
    title = "Median Residential Sale Price in Nashville (1970–2023)",
    x = "Year",
    y = "Median Sale Price (USD)"
  ) +
  scale_y_continuous(labels = scales::dollar)
```

## Time Series Decompisition 2000-2023

```{r}
data2000 <-data %>%
  filter(Year > 1999)  # filter year

# Aggregate to monthly median prices
ts_data <- data2000 %>%
  filter(!is.na(SaleDate), !is.na(SalePrice)) %>%
  mutate(YearMonth = floor_date(SaleDate, "month")) %>%
  group_by(YearMonth) %>%
  summarise(MedianPrice = median(SalePrice, na.rm = TRUE)) %>%
  arrange(YearMonth)

# Create a continuous monthly time series
sale_ts <- ts(
  ts_data$MedianPrice,
  start = c(year(min(ts_data$YearMonth)), month(min(ts_data$YearMonth))),
  end   = c(year(max(ts_data$YearMonth)), month(max(ts_data$YearMonth))),
  frequency = 12)

# Decompose
output <- decompose(sale_ts, type = "multiplicative")
plot(output)
```


## Distribution of Sale Prices 2020-2023


```{r}
data %>%
  filter(SalePrice > 1000, SalePrice < 2000000, Year > 2019) %>%  # filter extreme outliers and year
  ggplot(aes(x = SalePrice)) +
  geom_histogram(bins = 50, fill = "steelblue", color = "white") +
  labs(
    title = "Distribution of Sale Prices 2020-2023",
    x = "Sale Price (USD)",
    y = "Count"
  ) +
  scale_x_continuous(labels = scales::dollar)
```

  
  
  
